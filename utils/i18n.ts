export type Language = "en" | "zh";

export const translations = {
  en: {
    // Navigation
    "nav.codeImages": "Code Images",
    "nav.codeImages.desc": "Create beautiful images of your code",
    "nav.iconMaker": "Icon Maker",
    "nav.iconMaker.desc": "Create beautiful icons",
    "nav.prompts": "Prompts",
    "nav.prompts.desc": "Explore AI Prompts for Raycast",
    "nav.presets": "Presets",
    "nav.presets.desc": "Explore AI Presets for Raycast",
    "nav.quicklinks": "Quicklinks",
    "nav.quicklinks.desc": "Explore Raycast Quicklinks",
    "nav.snippets": "Snippets",
    "nav.snippets.desc": "Browse and import Raycast Snippets",
    "nav.themes": "Themes",
    "nav.themes.desc": "Browse and import Raycast Themes",

    // Common
    "common.about": "About",
    "common.shortcuts": "Shortcuts",
    "common.contribute": "Contribute",
    "common.language": "Language",
    "common.autoDetect": "Auto-Detect",
    "common.categories": "Categories",
    "common.size": "Size",
    "common.position": "Position",
    "common.undo": "Undo",
    "common.format": "Format Code",
    "common.download": "Download",
    "common.copy": "Copy",
    "common.save": "Save",
    "common.export": "Export",
    "common.share": "Share",
    "common.search": "Search",
    "common.select": "Select",
    "common.add": "Add",
    "common.remove": "Remove",
    "common.cancel": "Cancel",
    "common.close": "Close",
    "common.open": "Open",
    "common.loading": "Loading",
    "common.error": "Error",

    // Code Images
    "code.focusEditor": "Focus text editor",
    "code.unfocusEditor": "Unfocus text editor",
    "code.changeColors": "Change colors",
    "code.toggleBackground": "Toggle background",
    "code.toggleDarkMode": "Toggle dark mode",
    "code.toggleLineNumbers": "Toggle line numbers",
    "code.changePadding": "Change padding",
    "code.selectLanguage": "Select language",
    "code.highlightLine": "Highlight line",
    "code.formatCode": "Format code",
    "code.toggleExportMenu": "Toggle Export Menu",
    "code.savePNG": "Save PNG",
    "code.saveSVG": "Save SVG",
    "code.copyImage": "Copy image",
    "code.copyURL": "Copy URL",
    "code.openShortcuts": "Open shortcuts",
    "code.about.title": "About",
    "code.about.desc1": "Code Images by Raycast is a tool to create beautiful screenshots of your code.",
    "code.about.desc2":
      "Pick a theme from a range of syntax colors and backgrounds, the language of your code and choose between light or dark mode.",
    "code.about.desc3":
      "Customize the padding and when you're ready, click export image in the top-right corner to save the image as a png, svg or share a link to your code.",
    "code.about.desc4": "You can also change the image resolution in the export menu.",
    "code.about.contribute": "The project is Open Source and available on GitHub.",
    "code.about.feedback": "If you have any questions or feedback, please write to us on 𝕏 or send us an email.",

    // Export
    "export.savePNG": "Save PNG",
    "export.saveSVG": "Save SVG",
    "export.copyImage": "Copy Image",
    "export.copyURL": "Copy URL",
    "export.copyURLToShare": "Copy URL to Share",
    "export.downloadJSON": "Download JSON",
    "export.copyJSON": "Copy JSON",
    "export.addToRaycast": "Add to Raycast",
    "export.size": "Size",
    "export.toggleMenu": "Toggle Export Menu",

    // Instructions
    "instructions.installCommands": "Install AI Commands",
    "instructions.selectPrompt":
      "Select a prompt by clicking on it. Hold ⌘ to select multiple. Click Add to Raycast to import them directly.",
    "instructions.selectSnippet":
      "Select a snippet by clicking on it. Hold ⌘ to select multiple. Click Add to Raycast to import them directly.",
    "instructions.selectQuicklink":
      "Select a quicklink by clicking on it. Hold ⌘ to select multiple. Click Add to Raycast to import them directly.",
  },
  zh: {
    // Navigation
    "nav.codeImages": "代码图片",
    "nav.codeImages.desc": "创建美观的代码截图",
    "nav.iconMaker": "图标制作器",
    "nav.iconMaker.desc": "创建美观的图标",
    "nav.prompts": "提示词",
    "nav.prompts.desc": "探索 Raycast AI 提示词",
    "nav.presets": "预设",
    "nav.presets.desc": "探索 Raycast AI 预设",
    "nav.quicklinks": "快速链接",
    "nav.quicklinks.desc": "探索 Raycast 快速链接",
    "nav.snippets": "代码片段",
    "nav.snippets.desc": "浏览和导入 Raycast 代码片段",
    "nav.themes": "主题",
    "nav.themes.desc": "浏览和导入 Raycast 主题",

    // Common
    "common.about": "关于",
    "common.shortcuts": "快捷键",
    "common.contribute": "贡献",
    "common.language": "语言",
    "common.autoDetect": "自动检测",
    "common.categories": "分类",
    "common.size": "尺寸",
    "common.position": "位置",
    "common.undo": "撤销",
    "common.format": "格式化代码",
    "common.download": "下载",
    "common.copy": "复制",
    "common.save": "保存",
    "common.export": "导出",
    "common.share": "分享",
    "common.search": "搜索",
    "common.select": "选择",
    "common.add": "添加",
    "common.remove": "删除",
    "common.cancel": "取消",
    "common.close": "关闭",
    "common.open": "打开",
    "common.loading": "加载中",
    "common.error": "错误",

    // Code Images
    "code.focusEditor": "聚焦文本编辑器",
    "code.unfocusEditor": "取消聚焦文本编辑器",
    "code.changeColors": "更改颜色",
    "code.toggleBackground": "切换背景",
    "code.toggleDarkMode": "切换深色模式",
    "code.toggleLineNumbers": "切换行号",
    "code.changePadding": "更改内边距",
    "code.selectLanguage": "选择语言",
    "code.highlightLine": "高亮行",
    "code.formatCode": "格式化代码",
    "code.toggleExportMenu": "切换导出菜单",
    "code.savePNG": "保存 PNG",
    "code.saveSVG": "保存 SVG",
    "code.copyImage": "复制图片",
    "code.copyURL": "复制链接",
    "export.copyURLToShare": "复制分享链接",
    "code.openShortcuts": "打开快捷键",
    "code.about.title": "关于",
    "code.about.desc1": "Raycast 代码图片是一个创建美观代码截图的工具。",
    "code.about.desc2": "从各种语法颜色和背景中选择主题，选择代码语言并在明暗模式之间切换。",
    "code.about.desc3": "自定义内边距，准备好后，点击右上角的导出图片按钮，将图片保存为 PNG、SVG 或分享代码链接。",
    "code.about.desc4": "您还可以在导出菜单中更改图片分辨率。",
    "code.about.contribute": "该项目是开源的，可以在 GitHub 上找到。",
    "code.about.feedback": "如果您有任何问题或反馈，请在 𝕏 上联系我们或发送电子邮件。",

    // Export
    "export.savePNG": "保存 PNG",
    "export.saveSVG": "保存 SVG",
    "export.copyImage": "复制图片",
    "export.copyURL": "复制链接",
    "export.downloadJSON": "下载 JSON",
    "export.copyJSON": "复制 JSON",
    "export.addToRaycast": "添加到 Raycast",
    "export.size": "尺寸",
    "export.toggleMenu": "切换导出菜单",

    // Instructions
    "instructions.installCommands": "安装 AI 命令",
    "instructions.selectPrompt": '点击选择提示词。按住 ⌘ 可选择多个。点击"添加到 Raycast"直接导入。',
    "instructions.selectSnippet": '点击选择代码片段。按住 ⌘ 可选择多个。点击"添加到 Raycast"直接导入。',
    "instructions.selectQuicklink": '点击选择快速链接。按住 ⌘ 可选择多个。点击"添加到 Raycast"直接导入。',
  },
} as const;

export type TranslationKey = keyof typeof translations.en;

export function getBrowserLanguage(): Language {
  if (typeof window === "undefined") return "en";

  const browserLang = navigator.language.toLowerCase();
  if (browserLang.startsWith("zh")) {
    return "zh";
  }
  return "en";
}

const STORAGE_KEY = "ray-so-language";

export function getSavedLanguage(): Language {
  if (typeof window === "undefined") return "en";

  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved === "zh" || saved === "en") {
    return saved;
  }
  return getBrowserLanguage();
}

export function saveLanguage(lang: Language) {
  if (typeof window === "undefined") return;
  localStorage.setItem(STORAGE_KEY, lang);
}

export function getTranslation(key: TranslationKey, lang: Language): string {
  return translations[lang][key] || translations.en[key] || key;
}
